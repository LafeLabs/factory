
currentJSON.unit = unit;
currentJSON.x0 = x0;
currentJSON.y0 = y0;

currentJSON.x0rel = x0 - 0.5*innerWidth;
currentJSON.y0rel = y0 - 0.5*innerHeight;
   
ctx = document.getElementById("mainCanvas").getContext("2d");
ctx.clearRect(0,0,innerWidth,innerHeight);


doTheThing(0300);
drawGlyph(currentGlyph);

if(editMode){
    doTheThing(0300);
    side = 25;
    x = 150;
    y = innerHeight - 100;
    spellGlyph(currentGlyph);
}


    var glyphArray = currentGlyph.split(",");
    cleanGlyph = "";
    for(var index = 0;index < glyphArray.length;index++){
        if(glyphArray[index] != "0207" && glyphArray[index].length > 0){
            cleanGlyph += glyphArray[index] + ",";
        }
    }



currentJSON.glyph = cleanGlyph;

//un-comment the code below to make social:

if(path.length>1){
    currentFile = path + "json/currentjson.txt";
}
else{
    currentFile = "json/currentjson.txt";
}

data = encodeURIComponent(JSON.stringify(currentJSON,null, "    "));
var httpc = new XMLHttpRequest();
var url = "filesaver.php";        
httpc.open("POST", url, true);
httpc.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
httpc.send("data="+data+"&filename="+currentFile);//send text to filesaver.php





